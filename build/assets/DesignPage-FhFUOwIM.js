import{m as b,r as y,B as k,T as ee,j as a,w as ae,x as se,y as re}from"./index-BMlnTlrX.js";import{E as ie}from"./EditModal-BDXVwyzS.js";import"./cjs-DXZSJOm9.js";const te=()=>{var q;const H=b(),{setShowBShapeForm:x,showBShapeForm:g,bShapeForm:u,bSquareRef:P,bCircleRef:R,setBlockId:C,bShapeAdded:U,blockId:d,priceUpdated:_,setPriceUpdated:A,updateBShape:ce,bCircles:D,bSquares:$,setBCircles:O,setBSquares:V,layoutObject:n,setLayoutObject:p,blockDeleted:w,setBlockDeleted:z}=y.useContext(k),{setTShapeAdded:G,tShapeAdded:T,tableId:l,showTShapeForm:I,tShapeForm:j,setShowTShapeForm:S,tCircleRef:J,setTableId:B,tSquareRef:K,tCircles:Q,tSquares:W,setTCircles:X,setTSquares:Y,updateTShape:he}=y.useContext(ee),E=async()=>{const e=await ae(H.layoutIdParam);e.success&&p(e.layout)};y.useEffect(()=>{T&&(G(!1),E()),_&&A(!1),w&&z(!1),E()},[U,T,_,w]);const[L,F]=y.useState(!1),o=e=>{x(!0),C(e),F(!0)},M=e=>{x(!1),S(!0),B(e)};y.useEffect(()=>{const e=r=>{const c=r.target.closest(".block-square-shape"),h=r.target.closest(".hierarchy-blocks-name"),i=r.target.closest(".hierarchy-blocks-price"),s=r.target.closest(".block-circle-shape");!i&&!h&&!c&&!s&&u.current&&!u.current.contains(r.target)&&(x(!1),C(null),F(!1))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[P,u,R]),y.useEffect(()=>{const e=r=>{const c=r.target.closest(".square-shape"),h=r.target.closest(".circle-shape");!r.target.closest(".hierarchy-container")&&!c&&!h&&j.current&&!j.current.contains(r.target)&&(S(!1),B(null))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[K,j,J]);const m=[...D,...$].find(e=>e._id===d),N=async e=>{var i;const{name:r,value:c}=e.target,h=await Promise.all((i=n==null?void 0:n.blocks)==null?void 0:i.map(s=>{if(s._id===d){const t=Number(c),v={...s,[r]:t};return se(d,v,"Edit Block Hierarchy"),v}else return s}));p(s=>({...s,blocks:h})),(m==null?void 0:m.blockType.toLowerCase())==="circle"&&O(s=>s.map(t=>t._id===d?{...t,[r]:Number(c)}:t)),(m==null?void 0:m.blockType.toLowerCase())==="square"&&V(s=>s.map(t=>t._id===d?{...t,[r]:Number(c)}:t))},f=[...Q,...W].find(e=>e._id===l),Z=e=>{const{name:r,value:c}=e.target;p(h=>({...h,blocks:h.blocks.map(i=>{const s=i.tables.map(t=>{if(t._id===l){console.log("ðŸš€ ~ updatedTables ~ tableId:",l);const v={...t,[r]:c};return re(l,v),{...t,[r]:c}}return t});return{...i,tables:s}})})),(f==null?void 0:f.tableType.toLowerCase())==="circle"&&X(h=>h.map(i=>i._id===l?{...i,[r]:c}:i)),(f==null?void 0:f.tableType.toLowerCase())==="square"&&Y(h=>h.map(i=>i._id===l?{...i,[r]:c}:i))};return a.jsxs("div",{className:"hierarchy-container",children:[a.jsx("div",{className:"title-container-hierarchy",children:a.jsx("h1",{className:"hierarchy-title",children:"Layers"})}),a.jsx("h1",{className:"hierarchy-layout-name",children:n.name}),a.jsx("div",{className:"hierarchy-sub-container",children:(q=n==null?void 0:n.blocks)==null?void 0:q.map(e=>{var r,c,h,i;return a.jsx("div",{className:"hierarchy-all-effects-container",children:a.jsxs("div",{className:"hierarchy-vertical-blocks-container",children:[a.jsxs("div",{className:"hierarchy-vertical-border-container",children:[a.jsx("div",{className:"hierarchy-vertical-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-border-effect"})]}),a.jsxs("div",{className:"hierarchy-border-container",children:[a.jsx("div",{className:"hierarchy-border-effect"}),a.jsx("div",{className:"hierarchy-border-effect"}),a.jsx("div",{className:"hierarchy-border-effect"}),a.jsx("div",{className:"hierarchy-border-effect"}),a.jsx("div",{className:"hierarchy-border-effect"})]}),a.jsxs("div",{className:(e==null?void 0:e._id)===d&&g&&L?"hierarchy-tables-container hierarchy-highlight":"hierarchy-tables-container ",children:[a.jsx("h1",{className:(e==null?void 0:e._id)===d&&g&&L?"hierarchy-blocks-name hierarchy-highlight":"hierarchy-blocks-name ",onClick:()=>o(e==null?void 0:e._id),children:e==null?void 0:e.name}),(e==null?void 0:e.isMatched)&&(e==null?void 0:e.btickets)<1&&a.jsx("h1",{className:"dollar-sign",children:"$"}),(e==null?void 0:e.isMatched)&&((r=e==null?void 0:e.tables)==null?void 0:r.length)>0&&a.jsx("input",{className:"hierarchy-blocks-price",type:"number",name:"bprice",value:e==null?void 0:e.bprice,onClick:()=>o(e==null?void 0:e._id),onChange:s=>N(s)}),((c=e==null?void 0:e.tables)==null?void 0:c.length)<1&&(e==null?void 0:e.btickets)<1&&a.jsx("input",{className:"hierarchy-blocks-price none-events",type:"number",name:"bprice",value:(e==null?void 0:e.bprice)*(e==null?void 0:e.btickets),onClick:()=>o(e==null?void 0:e._id),onChange:s=>N(s)}),((h=e==null?void 0:e.tables)==null?void 0:h.length)<1&&a.jsx("div",{className:"hierarchy-all-tables-effects-container",children:a.jsxs("div",{className:d===e._id&&I?"hierarchy-vertical-blocks-container hierarchy-highlight":"hierarchy-vertical-blocks-container",children:[a.jsxs("div",{className:"hierarchy-vertical-border-container",children:[a.jsx("div",{className:"hierarchy-vertical-table-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-table-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-table-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-table-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-table-border-effect"})]}),a.jsxs("div",{className:"hierarchy-table-border-container",children:[a.jsx("div",{className:"hierarchy-table-border-effect"}),a.jsx("div",{className:"hierarchy-table-border-effect"}),a.jsx("div",{className:"hierarchy-table-border-effect"}),a.jsx("div",{className:"hierarchy-table-border-effect"}),a.jsx("div",{className:"hierarchy-table-border-effect"})]}),a.jsx("div",{children:a.jsx("h1",{className:"hierarchy-table-name hierarchy-tickets-position",onClick:()=>o(e._id),children:a.jsx("div",{className:"ticket-icon"})})}),a.jsx("div",{className:"hierarchy-tickets",children:a.jsx("h1",{className:"hierarchy-tickets-name",children:e==null?void 0:e.btickets})}),a.jsx("h1",{className:"dollar-sign-table-two",children:"$"}),a.jsx("input",{className:"hierarchy-ticket-price-position",type:"number",name:"bprice",value:e==null?void 0:e.bprice,onClick:()=>o(e==null?void 0:e._id),onChange:s=>N(s)})]})}),(i=e==null?void 0:e.tables)==null?void 0:i.map(s=>a.jsx("div",{className:"hierarchy-all-tables-effects-container",children:a.jsxs("div",{className:l===s._id&&I?"hierarchy-vertical-blocks-container hierarchy-highlight":"hierarchy-vertical-blocks-container",children:[a.jsxs("div",{className:"hierarchy-vertical-border-container",children:[a.jsx("div",{className:"hierarchy-vertical-table-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-table-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-table-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-table-border-effect"}),a.jsx("div",{className:"hierarchy-vertical-table-border-effect"})]}),a.jsxs("div",{className:"hierarchy-table-border-container",children:[a.jsx("div",{className:"hierarchy-table-border-effect"}),a.jsx("div",{className:"hierarchy-table-border-effect"}),a.jsx("div",{className:"hierarchy-table-border-effect"}),a.jsx("div",{className:"hierarchy-table-border-effect"}),a.jsx("div",{className:"hierarchy-table-border-effect"})]}),a.jsx("h1",{className:"hierarchy-table-name",onClick:()=>M(s._id),children:s==null?void 0:s.number}),a.jsx("h1",{className:"dollar-sign-table",children:"$"}),(e==null?void 0:e.isMatched)&&a.jsx("h1",{className:"lock-sign-table",children:"ðŸ”“"}),a.jsx("input",{className:e!=null&&e.isMatched?"hierarchy-table-price none-events":"hierarchy-table-price ",onClick:()=>M(s._id),onChange:t=>Z(t),type:"number",name:"tprice",value:e!=null&&e.isMatched?Math.ceil(e.bprice/(e==null?void 0:e.tables.length)):s.tprice})]})}))]})]})})})})]})},me=()=>a.jsxs("div",{className:"design-page-container",children:[a.jsx(te,{}),a.jsx("div",{children:a.jsx(ie,{})})]});export{me as default};
