import{a as y,b as I,r as n,A as C,G as S,u as D,j as e}from"./index-bNkgH9SL.js";import{S as j}from"./SpotMeUpIcon-DK-Xf-fB.js";const P=()=>localStorage.getItem("authToken"),T=async({name:a,lastName:u,email:i,telephone:d,address:m,nationalID:p,userProfileImage:h},x)=>{const c={name:a,lastName:u,email:i,telephone:d,address:m,nationalID:p,userProfileImage:h};try{const t=await y.put(`${I}/users/edit`,c,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${P()}`}});return localStorage.setItem("authToken",t.data.authToken),console.log("User updated:",t.data),console.log("response.data.user:",t.data.user),x(t.data.user),t.data}catch(t){throw console.error("Line 45 - Error",t),t}},A=()=>{const{user:a,setUser:u}=n.useContext(C),{isApiLoaded:i}=n.useContext(S),[d,m]=n.useState(null),[p,h]=n.useState(null),x=D(),c=n.useRef(null);n.useEffect(()=>{if(console.log("API Loaded:",i),i&&c.current){const o=new window.google.maps.places.Autocomplete(c.current,{componentRestrictions:{country:["DO"]},fields:["place_id","geometry","name","formatted_address","address_components"]});o.addListener("place_changed",()=>{const s=o.getPlace();console.log("formatted address:",s),s.formatted_address&&f(l=>({...l,address:s.name}))})}},[i]);const[t,f]=n.useState({name:(a==null?void 0:a.name)||"",lastName:(a==null?void 0:a.lastName)||"",email:(a==null?void 0:a.email)||"",telephone:(a==null?void 0:a.telephone)||"",address:(a==null?void 0:a.address)||"",nationalID:(a==null?void 0:a.nationalID)||"",userProfileImage:(a==null?void 0:a.userProfileImage)||""}),r=o=>{const{name:s,value:l}=o.target;if(s==="telephone"){const g=N(l);f(v=>({...v,[s]:g}))}else f(g=>({...g,[s]:l}))};n.useEffect(()=>{f({name:(a==null?void 0:a.name)||"",lastName:(a==null?void 0:a.lastName)||"",email:(a==null?void 0:a.email)||"",telephone:(a==null?void 0:a.telephone)||"",address:(a==null?void 0:a.address)||"",nationalID:(a==null?void 0:a.nationalID)||"",userProfileImage:(a==null?void 0:a.userProfileImage)||""})},[a]);const b=async o=>{o.preventDefault(),console.log("FormState - Line 52:",t);try{const s=await T(t,u);console.log("Line 24 - Response:",s),m(s.message),setTimeout(()=>{m(null),x("/")},3e3)}catch(s){console.error("Line 26 - Error:",s),s.response.data.message&&h(s.response.data.message),setTimeout(()=>{h(null)},3e3)}},N=o=>{let s=o.replace("+1","").replace(/[^\d]/g,"");s.length>10&&(s=s.substring(0,10));let l=s;return s.length>6?l=`+1(${s.slice(0,3)})-${s.slice(3,6)}-${s.slice(6,10)}`:s.length>3?l=`+1(${s.slice(0,3)})-${s.slice(3)}`:s.length>0&&(l=`+1(${s}`),l};return e.jsxs("form",{className:"profile-general-container",id:"profile-general-container",onSubmit:b,children:[d&&e.jsx("h1",{className:"profile-valid-prompt",children:d}),p&&e.jsx("h1",{className:"profile-invalid-prompt",children:p}),e.jsxs("div",{className:"icons-tabs-container-photoslider ",children:[e.jsx("div",{className:"icon-minimize"}),e.jsx("div",{className:"icon-maximize"}),e.jsx("div",{className:"icon-close"})]}),e.jsxs("div",{className:"profileform-body",id:"profileform-body",children:[e.jsxs("div",{className:"input-label-profile",children:[e.jsx("label",{htmlFor:"email",children:"E-mail"}),e.jsx("input",{type:"text",name:"email",onChange:r,value:t.email})]}),e.jsxs("div",{className:"input-label-profile-flex",children:[e.jsxs("div",{className:"input-label-profile",children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{type:"text",name:"name",onChange:r,value:t.name})]}),e.jsxs("div",{className:"input-label-profile",children:[e.jsx("label",{htmlFor:"lastName",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",onChange:r,value:t.lastName})]})]}),e.jsxs("div",{className:"input-label-profile",children:[e.jsx("label",{htmlFor:"telephone",children:"Telephone"}),e.jsx("input",{type:"text",name:"telephone",onChange:r,value:t.telephone})]}),e.jsxs("div",{className:"input-label-profile",children:[e.jsx("label",{htmlFor:"address",children:"Address"}),i&&e.jsx("input",{ref:c,type:"text",name:"address",onChange:r,value:t.address})]}),e.jsxs("div",{className:"input-label-profile",children:[e.jsx("label",{htmlFor:"nationalID",children:"nationalID"}),e.jsx("input",{type:"text",name:"nationalID",onChange:r,value:t.nationalID})]}),e.jsx("div",{className:"input-label-profile",children:e.jsx("button",{type:"submit",className:"editprofile-submit",children:"Save Changes"})})]}),e.jsx("div",{className:"spotmeupicon-profile-form",id:"spotmeupicon-profile-form",children:e.jsx(j,{})})]})},E=()=>e.jsxs("div",{className:"myprofiletab-container",id:"myprofiletab-container",children:[e.jsxs("div",{className:"profile-title-text",id:"profile-title-text",children:[e.jsx("h1",{children:"My"}),e.jsx("h1",{children:"Profile"})]}),e.jsxs("div",{className:"profiletab-container-image",children:[e.jsx("div",{className:"profilepicture",id:"profilepicture"}),e.jsxs("div",{className:"btns-profile-container",children:[e.jsx("button",{className:"signup-btn profile-btn",children:"Change Photo"}),e.jsx("button",{className:"signup-btn profile-btn",children:"Delete Account"})]})]})]}),M=()=>(n.useEffect(()=>(document.body.style.backgroundColor="#E1DDD4",()=>{document.body.style.backgroundColor="#3B7032"}),[]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"profile-container",children:[e.jsx("div",{className:"profileTabicon",id:"profileTabicon",children:e.jsx(j,{})}),e.jsx(E,{}),e.jsx(A,{})]})}));export{M as default};
